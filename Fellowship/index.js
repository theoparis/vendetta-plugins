(function(A,u,m,o,i,I,H,K,l){"use strict";const p=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(n){return typeof n=="object"&&!Array.isArray(n)};return[e,t(e[e.length-1])?e.pop():{}]},c=function(e,t){return t.all?o.findAll(e):o.find(e)},q=function(e){return c(e,{all:!0})},f={byProps:function(e){return function(t){return e.every(function(n){return t[n]!==void 0})}},byDisplayName:function(e,t){return t?function(n){return n?.displayName===e}:function(n){var r;return(n==null||(r=n.default)===null||r===void 0?void 0:r.displayName)===e}},byTypeName:function(e,t){return t?function(n){var r;return(n==null||(r=n.type)===null||r===void 0?void 0:r.name)===e}:function(n){var r,a;return(n==null||(a=n.default)===null||a===void 0||(r=a.type)===null||r===void 0?void 0:r.name)===e}},byName:function(e,t){return t?function(n){return n?.name===e}:function(n){var r;return(n==null||(r=n.default)===null||r===void 0?void 0:r.name)===e}}};var J=Object.freeze({__proto__:null,filters:f,getByDisplayName:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,a]=p(t);return c(f.byDisplayName(r[0],a.default),a)},getByName:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,a]=p(t);return c(f.byName(r[0],a.default),a)},getByProps:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,a]=p(t);return c(f.byProps(r),a)},getByTypeName:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,a]=p(t);return c(f.byTypeName(r[0],a.default),a)},getModule:c,getModules:q});const M=o.common.constants,Q=o.common.clipboard,W=o.findByProps("registerAsset"),D=o.findByProps("receiveMessage","sendMessage"),R=o.findByProps("createBotMessage"),z=o.findByProps("BOT_AVATARS"),X=o.common.ReactNative.NativeModules,Y=o.common.React,Z=o.common.FluxDispatcher,ee=o.findByProps("getItem"),ne=o.common.toasts,te=o.findByProps("show","openLazy","close"),re=o.findByProps("getToken"),ae=o.findByProps("getAPIBaseURL"),oe=o.findByProps("watchKeys"),ie=o.findByProps("getCurrentUser"),se=o.findByProps("getUser","fetchProfile"),ue=o.common.navigation,le=o.common.NavigationNative,ce=o.common.navigationStack,ge=o.findByProps("theme"),fe=o.common.ReactNative.Linking,k=o.common.stylesheet,de={ThemeColorMap:i.semanticColors,Colors:i.rawColors},me=i.semanticColors,pe=i.rawColors,ye={Forms:m.Forms,General:m.General},ve=o.findByProps("Messages"),he=o.findByProps("showUserProfile"),be=o.findByProps("debounce","throttle"),Pe=o.findByName("Logger"),Be=o.common.Flux,Ne=o.findByProps("Svg"),_e=o.findByName("getScreens",!1),we=o.common.moment;M.ThemeColorMap=i.semanticColors,k.ThemeColorMap=i.semanticColors;var Te=Object.freeze({__proto__:null,Assets:W,AsyncUsers:se,Avatars:z,Clipboard:Q,Clyde:R,ColorMap:de,Colors:pe,Components:ye,Constants:M,Dialog:te,Dispatcher:Z,Flux:Be,Linking:fe,Locale:ve,Lodash:be,Logger:Pe,Messages:D,Moment:we,Native:X,Navigation:ue,NavigationNative:le,NavigationStack:ce,Profiles:he,REST:ae,React:Y,SVG:Ne,Scenes:_e,Settings:oe,Storage:ee,StyleSheet:k,Theme:ge,ThemeColorMap:me,Toasts:ne,Token:re,Users:ie});const g={};function v(e,t,n){return g[e]||(g[e]={before:[],instead:[],after:[]}),g[e][t].push(n),{unpatch:n}}function h(e,t){switch(e){case"before":return function(n,r){return t(this,n,r),r(...n)};case"instead":return function(n,r){return t(this,n,r)};case"after":return function(n,r){return t(this,n,r)}}}const $=function(e,t,n,r,a){return v(e,"before",u.patcher.instead(n,t,h("before",r),a))},j=function(e,t,n,r,a){return v(e,"instead",u.patcher.instead(n,t,h("instead",r),a))},O=function(e,t,n,r,a){return v(e,"after",u.patcher.after(n,t,h("after",r),a))},b=function(e){return[...g[e].before,...g[e].instead,...g[e].after]},x=function(e){return b(e).forEach(function(t){return t()})};var Ce=Object.freeze({__proto__:null,after:O,before:$,create:function(e){return{getPatchesByCaller:function(){return b(e)},before:function(t,n,r,a){return $(e,t,n,r,a)},instead:function(t,n,r,a){return j(e,t,n,r,a)},after:function(t,n,r,a){return O(e,t,n,r,a)},unpatchAll:function(){return x(e)}}},getPatchesByCaller:b,instead:j,unpatchAll:x});function P(e,t){return u.logger.warn(`Tried to call ${e}, not implemented!`),t}const B={};function N(e,t){B[e]??(B[e]=[]);for(const n of t)B[e].push(K.registerCommand({name:n.name,displayName:n.name,description:n.description,displayDescription:n.description,type:1,inputType:1,applicationId:"-1",options:n.options,execute:n.execute}))}const L=function(e){var t;return(t=N[e])===null||t===void 0?void 0:t.forEach(function(n){return n()})};var Se=Object.freeze({__proto__:null,registerCommands:N,unregisterCommands:L}),U;(U=I.storage).plugins??(U.plugins={});let _={},s=I.storage.plugins;function E(e){if(typeof e!="object")return;const t=Object.entries(s).find(function(n){let[,r]=n;return r.name===e.name})[0];_[t]={onStart:e.onStart,onStop:e.onStop,onEnable:function(){try{e.onStart(),e.commands&&N(e.name,e.commands)}catch(n){console.error(`${e.name} errored while enabling`,n.message)}},onDisable:function(){try{e.patches&&e.patches.forEach(function(n){return n.unpatchAll()}),e.commands&&L(e.name),e.onStop()}catch(n){console.error(`${e.name} errored while disabling`,n.message)}}}}const F=function(e,t){return H.without({...e,...t},"script","enabled")},w=function(e){return(e?Object.entries(s).filter(e):Object.entries(s)).map(function(t){let[n,r]=t;return F(r,_[n])})};function Ae(e){const[t,n]=Object.entries(s).find(function(r){let[,a]=r;return a.name===e});return F(n,_[t])}const Ie=function(){return w()},Me=function(){return w(function(e){let[,t]=e;return t.enabled})},De=function(){return w(function(e){let[,t]=e;return!t.enabled})},Re=function(e){return new Proxy(globalThis.enmity.plugins,{get(t,n){return n!=="registerPlugin"?Reflect.get(t,n):function(r){return s[e]??(s[e]={name:r.name,description:r.description,version:r.version,authors:r.authors}),E(r)}}})};async function V(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;var n;const r=((n=s[e])===null||n===void 0?void 0:n.script)??await(await fetch(e)).text(),a={...globalThis.enmity,plugins:Re(e)},y=new Proxy(window,{get(C,S){if(S==="window")return y;switch(S){case"vendetta":case"__vendetta_theme":case"__vendetta_loader":case"__vendetta_rdc":return;case"enmity":return a;default:return C[S]}}});try{await(0,eval)(`((window, enmity) => { ${r} })`)(y,a)}catch(C){console.error(C.stack)}return s[e].script=r,s[e].enabled=t,s[e].name}function ze(e,t){V(e,!0)}var ke=Object.freeze({__proto__:null,evalPlugin:V,getDisabledPlugins:De,getEnabledPlugins:Me,getPlugin:Ae,getPlugins:Ie,installPlugin:ze,registerPlugin:E,uninstallPlugin:async function(){return P("uninstallPlugin")}});function $e(e,t,n,r){const a=R.createBotMessage({channelId:e,content:""});a.author.username=n??"Fellowship",a.author.avatar=r?n:"clyde",r&&z.BOT_AVATARS[n],typeof t=="string"?a.content=t:Object.assign(a,t),D.receiveMessage(e,a)}var je=Object.freeze({__proto__:null,sendReply:$e});const{uuid4:Oe}=o.findByProps("uuid4"),xe=function(e){return l.lodash.memoize(e)},Le=function(e,t){return l.lodash.debounce(e,t)},Ue=function(){return P("createStore",{})},Ee=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(r){return r},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.utils.findInTree(e,t,{walkable:["props","children"],...n})},Fe=l.ReactNative.PixelRatio.getPixelSizeForLayoutSize;var Ve=Object.freeze({__proto__:null,createStore:Ue,debounce:Le,findInReactTree:Ee,findInTree:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(y){return y},{ignore:n=[],walkable:r=[],maxProperties:a=100}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.utils.findInTree(e,t,{ignore:n,walkable:r,maxDepth:a})},memoize:xe,normalizeSize:Fe,sleep:function(e){return new Promise(function(t){return setTimeout(t,e)})},uuid:Oe,wrapInHooks:function(){return P("wrapInHooks",l.React.createElement(l.ReactNative.Text,{},"Stubbed wrapInHooks"))}});const{NativeModules:d}=l.ReactNative,T=d.InfoDictionaryManager??d.RTNClientInfoManager,G=d.DCDDeviceManager??d.RTNDeviceManager,Ge=d.BundleUpdaterManager,He=T.Identifier,Ke=Ge.reload,qe=T.Version,Je=G.systemVersion,Qe=T.Build,We=G.device;var Xe=Object.freeze({__proto__:null,build:Qe,bundle:He,device:We,os:Je,reload:Ke,version:qe});const Ye=i.assets.all,Ze=i.assets.find,en=function(e){return i.assets.getAssetByName(e)},nn=function(e){return i.assets.getAssetByID(e)},tn=function(e){return i.assets.getAssetIDByName(e)},rn=new Proxy({},{get:function(e,t){return i.assets.getAssetIDByName(t)}});var an=Object.freeze({__proto__:null,Icons:rn,assets:Ye,find:Ze,getByID:nn,getByName:en,getIDByName:tn});function on(){return globalThis.enmity={modules:{...J,common:Te},patcher:Ce,version:`Fellowship ${u.plugin.manifest.hash.slice(7)}`,plugins:ke,clyde:je,commands:Se,utilities:Ve,components:new Proxy({},{get:function(e,t){return m.General[t]??m.Forms[t]}}),native:Xe,assets:an},function(){return delete globalThis.enmity}}const sn=[on()],un=function(){return sn.forEach(function(e){return e()})};return A.onUnload=un,A})({},vendetta,vendetta.ui.components,vendetta.metro,vendetta.ui,vendetta.plugin,vendetta.utils,vendetta.commands,vendetta.metro.common);
